{
  "name": "Agente IA Administrativo CUC",
  "nodes": [
    {
      "parameters": {
        "public": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -1296,
        -256
      ],
      "id": "20a5d6c3-8c93-45de-97f1-33bf8f72dde5",
      "name": "When chat message received",
      "webhookId": "7c6b90be-68d2-43f4-9cec-950fb9273999"
    },
    {
      "parameters": {
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=# Rol\nEres un agente de IA con conocimiento generales del mundo y temas administrativos del CUC (Colegio Univeristario de Cartago).\n\n# Contexto\nActuas con base a unas preguntas de los usuarios y tienes la habilidad de activar herramientas/tools para acceder a nuevos conocimientos y nuevas acciones que no puedes hacer normalmente\n\n# Tools/Heramientas\nVamos a definir las tools a las que tienes acceso y cuando utilizarla:\n\n-Microsoft Excel 365: Esta es una Herramienta nos permite consultar el archivo excel \"Estudiantes.xlsx\" con los Estudiantes y Notas del III Cuatrimestre 2025 de la carrera de Big Data y TI. \n\nTienes 2 herramientas de Excel:\n1. Excel Matricula - Lee estudiantes de la Hoja 1\n2. Excel Notas - Lee las notas de la Hoja 1\n\nIMPORTANTE:\n- Siempre llama a las herramientas cuando te pregunten asuntos relacionados al CUC\n- Procesa los datos de ambas hojas\n- Da respuestas precisas con números exactos\n- Tambien puede reponder cualquier consulta con tus conocimientos generales\n\n- Tool: Gmail - Enviar Correos: Envía correos electrónicos desde la cuenta de gmail\n\nCUÁNDO USAR:\n- El usuario pide explícitamente \"enviar\", \"envía\", \"manda\" un correo/email\n- Solicita notificar a alguien por correo\n- Requiere un reporte por email\n- Pide alertar/avisar por correo\n\nPARÁMETROS:\n- to: email del destinatario\n- subject: asunto descriptivo y profesional\n- body: contenido en formato HTML\n\nFORMATO DE EMAIL:\n```html\n\n\n\n    [TÍTULO]\n    \n    Estimado/a [Nombre],\n    \n    [Contenido principal]\n    \n    \n        [Datos importantes con formato]\n    \n    \n    Saludos cordiales,\n    Sistema Automatizado CUC\n    Colegio Universitario de Cartago\n    \n    \n    \n        Este correo fue generado automáticamente. \n        Fecha: [timestamp]\n    \n\n\n```\n\nIMPORTANTE:\n-Siempre usa formato HTML profesional\n-Incluye saludo y despedida\n-Asunto claro y descriptivo\n-Confirma el envío al usuario\n\n\n# Tarea\nEl objetivo tuyo como agente de IA, es ayudar al usuario a resolver de la mejor forma posible sus inquietudes.\n\ny vas a hacer uso siempre de las herrramientas de la siguiente forma\n\n## Paso 1\nAnalizar el mensaje del usuario y definir si se debe utilizar una o mas herramientas a las que tienes acceso\n\n## Paso 2\nActivar las tool/herramientas cuantas veces sea necesario para brindar una respuesta correcta al usuario\n\n## Paso 3\nSi las respuestas son fuera del contexto del CUC tambien puedes responderlas\n\n# Formato\nvas a adecuar el formato segun la necesidad del usuario\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -992,
        -256
      ],
      "id": "fe65758d-388a-4261-b0cc-713e9eb3b01b",
      "name": "AI Agent"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -976,
        0
      ],
      "id": "498a3f11-8785-4171-ab9e-a4b8fa042a8d",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -1152,
        -48
      ],
      "id": "5e5676bb-e4f8-450e-97b6-b7da5419ccd0",
      "name": "Google Gemini Chat Model"
      
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Lee todas las notas del archivo Estudiantes.xlsx. \n   Retorna Nombre Completo, Materia y Nota",
        "resource": "worksheet",
        "operation": "readRows",
        "workbook": {
          "__rl": true,
          "value": "014L66T7XFXYH5CJA565FJ4RL6L6LZLNL7",
          "mode": "list",
          "cachedResultName": "Notas",
          "cachedResultUrl": ""
        },
        "worksheet": {
          "__rl": true,
          "value": "{6858F2C4-3C3B-40E2-8606-6EC75BFE5C51}",
          "mode": "list",
          "cachedResultName": "Notas",
          "cachedResultUrl": ""
        },
        "options": {}
      },
      "type": "n8n-nodes-base.microsoftExcelTool",
      "typeVersion": 2.2,
      "position": [
        -816,
        -16
      ],
      "id": "895c4418-87dd-41de-aee8-90b36fe354bf",
      "name": "Excel Notas"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Lee todos los estudiantes de la Estudiantes del archivo Estudiantes.xlsx. \n   Retorna Nombre Completo, Carné y Carrera",
        "resource": "worksheet",
        "operation": "readRows",
        "workbook": {
          "__rl": true,
          "value": "014L66T7XPNESZB6GXMBBJHOMLWXKXYF3S",
          "mode": "list",
          "cachedResultName": "Estudiantes",
          "cachedResultUrl": ""
        },
        "worksheet": {
          "__rl": true,
          "value": "{00000000-0001-0000-0000-000000000000}",
          "mode": "list",
          "cachedResultName": "Estudiantes",
          "cachedResultUrl": ""
        },
        "options": {}
      },
      "type": "n8n-nodes-base.microsoftExcelTool",
      "typeVersion": 2.2,
      "position": [
        -672,
        -32
      ],
      "id": "9d9514b6-9e5c-4720-971b-8d659e74e59d",
      "name": "Excel Matricula"      
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Envía correos electrónicos desde  la cuenta institucional. Puede enviar reportes, notificaciones y alertas a estudiantes, profesores o administrativos del CUC.",
        "sendTo": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('To', ``, 'string') }}",
        "subject": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Subject', ``, 'string') }}",
        "message": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Message', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmailTool",
      "typeVersion": 2.1,
      "position": [
        -464,
        -80
      ],
      "id": "754ef5fd-715c-41f7-8e83-471cb0020792",
      "name": "Correo Gmail",
      "webhookId": "53432be7-83c9-44c9-a7a1-b48553ca1488"
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        []
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Excel Notas": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Excel Matricula": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Correo Gmail": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "3109986b-654c-4460-abb7-0221c19312a3",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "0568961136e3551a7cdb371851330a40306bb13e8d87b087163a5847479f25e4"
  },
  "id": "p3SycbiOTiGVPfcl",
  "tags": []
}