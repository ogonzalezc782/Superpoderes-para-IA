{
  "name": "Agente IA Administrativo CUC",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.1,
      "position": [
        -1152,
        -256
      ],
      "id": "20a5d6c3-8c93-45de-97f1-33bf8f72dde5",
      "name": "When chat message received",
      "webhookId": "7c6b90be-68d2-43f4-9cec-950fb9273999"
    },
    {
      "parameters": {
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=# Rol\nEres un agente de IA con conocimiento generales del mundo y temas administrativos del CUC.\n\n# Contexto\nActuas con base a unas preguntas de los usuarios y tienes la habilidad de activar herramientas/tools para acceder a nuevos conocimientos y nuevas acciones que no puedes hacer normalmente\n\n# Tools/Heramientas\nVamos a definir las tools a las que tienes acceso y cuando utilizarla:\n\n-Microsoft Excel 365: Esta es una Herramienta nos permite consultar el archivo excel \"Estudiantes.xlsx\" con los Estudiantes y Notas del III Cuatrimestre 2025 de la carrera de Big Data y TI. \n\nTienes 2 herramientas de Excel:\n1. Excel Matricula - Lee estudiantes de la Hoja 1\n2. Excel Notas - Lee las notas de la Hoja 1\n\nIMPORTANTE:\n- Siempre llama a las herramientas cuando te pregunten asuntos relacionados al CUC\n- Procesa los datos de ambas hojas\n- Da respuestas precisas con números exactos\n- Tambien puede reponder cualquier consulta con tus conocimientos generales\n\n\n# Tarea\nEl objetivo tuyo como agente de IA, es ayudar al usuario a resolver de la mejor forma posible sus inquietudes.\n\ny vas a hacer uso siempre de las herrramientas de la siguiente forma\n\n## Paso 1\nAnalizar el mensaje del usuario y definir si se debe utilizar una o mas herramientas a las que tienes acceso\n\n## Paso 2\nActivar las tool/herramientas cuantas veces sea necesario para brindar una respuesta correcta al usuario\n\n## Paso 3\nSi las respuestas son fuera del contexto del CUC tambien puedes responderlas\n\n# Formato\nvas a adecuar el formato segun la necesidad del usuario\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -808,
        -256
      ],
      "id": "fe65758d-388a-4261-b0cc-713e9eb3b01b",
      "name": "AI Agent"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -800,
        -32
      ],
      "id": "498a3f11-8785-4171-ab9e-a4b8fa042a8d",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        -928,
        -32
      ],
      "id": "5e5676bb-e4f8-450e-97b6-b7da5419ccd0",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "dDf17w4HIsjHOny0",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Lee todas las notas del archivo Estudiantes.xlsx. \n   Retorna Nombre Completo, Materia y Nota",
        "resource": "worksheet",
        "operation": "readRows",
        "workbook": {
          "__rl": true,
          "value": "014L66T7XFXYH5CJA565FJ4RL6L6LZLNL7",
          "mode": "list",
          "cachedResultName": "Notas",
          "cachedResultUrl": "https://cuccr-my.sharepoint.com/personal/ogonzalezc_cuc_ac_cr/_layouts/15/Doc.aspx?sourcedoc=%7BD10FBEE5-1D24-4AF7-9E45-7E5F9795B57F%7D&file=Notas.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1"
        },
        "worksheet": {
          "__rl": true,
          "value": "{6858F2C4-3C3B-40E2-8606-6EC75BFE5C51}",
          "mode": "list",
          "cachedResultName": "Notas",
          "cachedResultUrl": "https://cuccr-my.sharepoint.com/personal/ogonzalezc_cuc_ac_cr/_layouts/15/Doc.aspx?sourcedoc=%7BD10FBEE5-1D24-4AF7-9E45-7E5F9795B57F%7D&file=Notas.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1&activeCell=Notas!A1"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.microsoftExcelTool",
      "typeVersion": 2.2,
      "position": [
        -672,
        -32
      ],
      "id": "895c4418-87dd-41de-aee8-90b36fe354bf",
      "name": "Excel Notas",
      "credentials": {
        "microsoftExcelOAuth2Api": {
          "id": "aCA2FYD6TZ4P46li",
          "name": "Microsoft Excel account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Lee todos los estudiantes de la Estudiantes del archivo Estudiantes.xlsx. \n   Retorna Nombre Completo, Carné y Carrera",
        "resource": "worksheet",
        "operation": "readRows",
        "workbook": {
          "__rl": true,
          "value": "014L66T7XPNESZB6GXMBBJHOMLWXKXYF3S",
          "mode": "list",
          "cachedResultName": "Estudiantes",
          "cachedResultUrl": "https://cuccr-my.sharepoint.com/personal/ogonzalezc_cuc_ac_cr/_layouts/15/Doc.aspx?sourcedoc=%7B902569EF-D7F8-4260-93B9-8BB5D57C1772%7D&file=Estudiantes.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1"
        },
        "worksheet": {
          "__rl": true,
          "value": "{00000000-0001-0000-0000-000000000000}",
          "mode": "list",
          "cachedResultName": "Estudiantes",
          "cachedResultUrl": "https://cuccr-my.sharepoint.com/personal/ogonzalezc_cuc_ac_cr/_layouts/15/Doc.aspx?sourcedoc=%7B902569EF-D7F8-4260-93B9-8BB5D57C1772%7D&file=Estudiantes.xlsx&action=default&mobileredirect=true&DefaultItemOpen=1&activeCell=Estudiantes!A1"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.microsoftExcelTool",
      "typeVersion": 2.2,
      "position": [
        -544,
        -32
      ],
      "id": "9d9514b6-9e5c-4720-971b-8d659e74e59d",
      "name": "Excel Matricula",
      "credentials": {
        "microsoftExcelOAuth2Api": {
          "id": "aCA2FYD6TZ4P46li",
          "name": "Microsoft Excel account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        []
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Excel Notas": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Excel Matricula": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "6b4ac9e8-1c8f-4d15-b998-c77eb7aaf7fe",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "0568961136e3551a7cdb371851330a40306bb13e8d87b087163a5847479f25e4"
  },
  "id": "p3SycbiOTiGVPfcl",
  "tags": []
}